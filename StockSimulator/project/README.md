
#  CS50 Web Development Final Project - StockSimulator

# Contents
- [Overview](#overview)
- [How to use](#how-to-use)
- [Distinctiveness and Complexity](#distinctiveness-and-complexity)
- [Project Layout and Code](#project-layout-and-code)
   - [File Layout](#file-layout)
   - [JavaScript Files](#javascript-files)
   - [HTML Templates](#html-templates)
   - [Python Files](#python-files)
      - [views.py](#views.py)
- [How to run the Application](#how-to-run-the-application)
- [Third-Party Packages](#third-party-packages)

# Overview

For my final project I have created a web application which serves as a visualisation tool allowing users to see how their market insights might affect a stock. It allows a user to define their own custom stocks and simulate their performance if the stock were in a bubble. It does this by allowing the user to define a volatility as well as average annual change for the stock. The user can then also define events which happen throughout the year and they can define the impact these events will have on the stocks. They can then run the simulation which will attempt to model how the stock changes throughout the year.

#  How to use

The default route leads to the home page with a navigation bar at the top. From here you can click register and make an account. Once you have an account, navigate to the **Stocks** tab where you can create your own stocks. You can then navigate to the **Portfolio** tab and add a desired amount of the stock to your portfolio before navigating to the **Events** tab and defining some events. Both stocks and events can be edited by being clicked on in their respective tabs. Once you are happy, you can navigate to the **Simulator** tab. From here you can add your events to the simulator and specify a date on which they occur. You can then press the **Start Simulation** button which will run the simulation and then jump to the simulation results.

#  Distinctiveness and Complexity

My StockSimulator web application is distinct from other projects in this course and shares little similarity with them. It is designed to be used as a tool for individuals rather than a service like the other projects in the course, such as the auction or social network. While the other projects focus on a platform which facilitates some level of communication between multiple users, my application performs a task for the user rather than connect two users. It also has a different background from the other projects as it is related to stocks and finance and has no relation to social networks or e-commerce. 

My project is also distinct from others like it as it doesn't aim to predict the stock market like many other tools out there, but rather simulate its potential movements based entirely on user inputs. This means the user can manipulate the simulation and shape it entirely to suit their personal goals.

It is also sufficiently complex as it involves most of the concepts shown in the course and more. It uses more complicated bootstrap concepts than those shown in the course, allowing for greater customisation and mobile responsiveness. The navigation bar for example changes on a smaller screen into a navigation drawer making the application easier to interact with on a mobile device. The page content layout also changes to make it easier to read and navigate on smaller devices. The application also makes use of different django features such as users and forms and it is capable of handling both get and post requests, returning JSON responses where appropriate.

It also makes use of additional JavaScript frameworks such as eCharts and uses multiple models on the backend with different relationships including many to many relationships. There are also multiple JavaScript files allowing for a smooth front end user experience and a robust back end which includes input validation to ensure that the application runs without errors.

The project has additional complexity when simulating a stock's performance. This requires a complex algorithm which needs to take several factors into consideration including volatility, average annual change and potential events in order to calculate things such as the daily change and daily return with and without events.

#  Project Layout and Code

##  File Layout

The project is split up with JavaScript and CSS files found under `app/static/app` and HTML templates found under `app/templates/app`. The app directory also contains all the python files generated by a django project as well as an additional `forms.py` file which contains django forms.

##  JavaScript Files

There are two JavaScript files. The first is `charts.js` and it contains functions for creating a line chart as well as a doughnut chart using eCharts. This allows me to keep the chart configurations for each chart type in a seperate file rather than repeat them every time I want to create a new chart. These functions are then used elsewhere such as in the second file which is `simulator.js`. 

This file is responsible for adding and removing events in the simulator page as well as generating and displaying all of the simulation results when the start simulation button is pressed. It has events listeners which listen for button presses and then send a post request to the server in order to retrieve the simulation results. The file then interprets these results to calculate useful statistics about the simulation before using the chart functions to generate charts and add them to the page, allowing the user to view the results without refreshing.

##  HTML Templates

There are a total of 10 HTML template files with 9 of them corresponding to a page in the application. They all inherit from a `layout.html` file which defines the basic layout of the page including the navigation bar at the top of the page. These templates all use django's formatting language to customise the page and make it dynamic. The `simulator.html` also contains template elements which have been kept hidden. These template elements represent the layout that the simulation results should be shown in and they can then be cloned in JavaScript and easily modified for each result.

##  Python Files

The `forms.py` file contains forms which are used to receive data from the front end. These include forms for creating and editing stocks and well as creating and editing events. This allows me to use some of django's in-built validation to ensure that I get the data in the form that I want it. 

The `models.py` file then defines four models. There is a *Stock* model, an *Event* model and a *Portfolio* model as well as a *StockInPortfolio* model which is used as a linking table between the *Stock* and *Portfolio* models. This allows the user to save different stocks and events and then add stocks to their portfolio. 

The `urls.py` file then defines the urlpatterns for the application and the `views.py` file defines each view as below.

###  `views.py`

The `views.py` file contains the following functions:

-  **`index`** - This defines the default view for the application. It simply returns `index.html`.

-  **`login_view`**, **`logout_view`**, **`register`** - These are basic views for user authentication. They allow the user to register for an account and then login to that account. The `logout_view` function then logs a user out and redirects them to the `index` view.

-  **`stocks`**, **`new_stock`**, **`edit_stock`**, **`delete_stock`** - The `stocks` and `new_stock` views both return respective html templates allowing the user to view their stocks or view the page for creating new stocks. The `new_stock`, `edit_stock` and `delete_stock` views all accept post requests and allow new stocks to be made, old stocks to be edited and stocks to be deleted.

-  **`events`**, **`new_event`**, **`edit_event`**, **`delete_event`** - These views function the same as their stocks counterparts but instead show all events and then allow for the creation, modification and deletion of events rather than stocks.

-  **`portfolio`**, **`add_stock`**, **`remove_stock`** - The `portfolio` view allows you to view your portfolio and add stocks to it by returning the `portfolio.html` template. This allows a post request to be submitted to the `add_stock` view which allows you to add a stock to your portfolio. The `remove_stock` method can also be called and removes a stock from your portfolio.

-  **`simulator`**, **`simulation`** - The `simulator` view calculates the data required for creating a portfolio chart and passes this into the `simulator.html` template before returning it to the user. This allows the user to access the actual simulator and run simulations. When they click the run simulation button, a post request is sent to the `simulation` view. This is responsible for actually running the simulation and then returning the results in a JSON response.

#  How to run the application

To run the application you must first run the following commands to get the latest migrations:

-  `python manage.py makemigrations app`

-  `python manage.py migrate`

Once you have made the migrations you can run `python manage.py runserver` to start the application.

#  Third-Party Packages

I have used a few different frameworks to help create the front end. Alongside bootstrap's CSS, I have included its JavaScript bundle which includes `popper.js` which I use for customising tooltip content. I have also used [Apache Echarts](https://cdn.jsdelivr.net/npm/echarts@5.5.1/dist/echarts.min.js) to create line and doughnut charts. In the backend, I have used numpy as part of the simulation to help generate daily stock movements.
